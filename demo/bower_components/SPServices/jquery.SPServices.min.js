!function(a){"use strict";function b(b,c){var d,e,f,g,h,i="",j=null,k=c.Obj.data("SPCascadeDropdownsChildColumns");a(k).each(function(){var b=this.opt,k=this.childSelect,l=this.childColumnStatic,m=this.childColumnRequired;d=w(c,b.matchOnId);var n=d.join(";#");if(c.Obj.data("SPCascadeDropdown_Selected_"+l)!==n){c.Obj.data("SPCascadeDropdown_Selected_"+l,n),j=w(k,!0);var o=b.relationshipListSortColumn.length>0?b.relationshipListSortColumn:b.relationshipListChildColumn,p="<Query><OrderBy><FieldRef Name='"+o+"'/></OrderBy><Where><And>";if(b.CAMLQuery.length>0&&(p+="<And>"),0===d.length)p+="<Eq><FieldRef Name='"+b.relationshipListParentColumn+"'/><Value Type='Text'></Value></Eq>";else if(1===d.length)p+="<Eq><FieldRef Name='"+b.relationshipListParentColumn+(b.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+J(d[0])+"</Value></Eq>";else{var q=d.length>2?!0:!1;for(sb=0;sb<d.length-1;sb++)p+="<Or>";for(sb=0;sb<d.length;sb++)p+="<Eq><FieldRef Name='"+b.relationshipListParentColumn+(b.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+J(d[sb])+"</Value></Eq>",sb>0&&sb<d.length-1&&q&&(p+="</Or>");p+="</Or>"}b.CAMLQuery.length>0&&(p+=b.CAMLQuery+"</And>"),p+="<IsNotNull><FieldRef Name='"+b.relationshipListChildColumn+"' /></IsNotNull>",p+="</And></Where></Query>",a().SPServices({operation:"GetListItems",async:!1,webURL:b.relationshipWebURL,listName:b.relationshipList,CAMLQuery:p,CAMLViewFields:"<ViewFields><FieldRef Name='"+b.relationshipListParentColumn+"' /><FieldRef Name='"+b.relationshipListChildColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:b.CAMLQueryOptions,completefunc:function(c){switch(a(c.responseXML).find("errorstring").each(function(){var c="SPServices.SPCascadeDropdowns",d=a(this).text();b.debug&&"One or more field types are not installed properly. Go to the list settings page to delete these fields."===d?x(c,"relationshipListParentColumn: "+b.relationshipListParentColumn+" or relationshipListChildColumn: "+b.relationshipListChildColumn,"Not found in relationshipList "+b.relationshipList):b.debug&&"Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."===d&&x(c,"relationshipList: "+b.relationshipList,"List not found")}),k.Type){case T.simple:a(k.Obj).find("option").remove(),!m&&b.promptText.length>0?k.Obj.append("<option value='0'>"+b.promptText.replace(/\{0\}/g,b.childColumn)+"</option>"):m||k.Obj.append("<option value='0'>"+b.noneText+"</option>");break;case T.complex:i=m?"":b.noneText+"|0",k.Obj.val("");break;case T.multiSelect:a(k.master.candidateControl).find("option").remove(),e=""}switch(f=parseFloat(a(c.responseXML).SPFilterNode("rs:data").attr("ItemCount")),a(c.responseXML).SPFilterNode("z:row").each(function(){var c={},d=a(this).attr("ows_"+b.relationshipListChildColumn);switch("undefined"!=typeof d&&d.indexOf(";#")>0?c=new L(d):(c.id=a(this).attr("ows_ID"),c.value=d),isNaN(c.id)&&(c.id=a(this).attr("ows_ID")),g=c.id,h=c.value,k.Type){case T.simple:var f=a(this).attr("ows_ID")===j[0]?" selected='selected'":"";k.Obj.append("<option"+f+" value='"+c.id+"'>"+c.value+"</option>");break;case T.complex:c.id===j[0]&&k.Obj.val(c.value),i=i+(i.length>0?"|":"")+c.value+"|"+c.id;break;case T.multiSelect:a(k.master.candidateControl).append("<option value='"+c.id+"'>"+c.value+"</option>"),e+=c.id+"|t"+c.value+"|t |t |t"}}),k.Type){case T.simple:k.Obj.trigger("change"),1===f&&b.selectSingleOption===!0&&a(k.Obj).find("option[value!='0']:first").attr("selected","selected");break;case T.complex:k.Obj.attr("choices",i),1===f&&b.selectSingleOption===!0&&(a(k.Obj).val(h),k.optHid.val(g)),""===k.Obj.val()&&k.optHid.val("");break;case T.multiSelect:k.master.data="",k.MultiLookupPickerdata.val(e),a(k.master.resultControl).find("option").each(function(){var b=a(this);b.prop("selected",!0),a(k.master.candidateControl).find("option[value='"+b.val()+"']").each(function(){b.prop("selected",!1)})}),GipRemoveSelectedItems(k.master),a(k.master.candidateControl).find("option").each(function(){var b=a(this);a(k.master.resultControl).find("option[value='"+b.val()+"']").each(function(){b.remove()})}),GipAddSelectedItems(k.master),k.master.data=GipGetGroupData(e),a(k.master.candidateControl).trigger("dblclick")}}}),null!==b.completefunc&&b.completefunc()}})}function c(b,c,d,e){var f=null,g="SPServices.SPDisplayRelatedInfo",h=a().SPServices.SPDropdownCtl({displayName:b.columnName});if(f=w(h,b.matchOnId),!(h.Type===T.complex&&b.numChars>0&&f[0].length<b.numChars)&&h.Obj.attr("showRelatedSelected")!==f[0]){h.Obj.attr("showRelatedSelected",f[0]),a("#"+c).remove(),h.Obj.parent().append("<div id="+c+"></div>");var i="<Query><Where>";b.CAMLQuery.length>0&&(i+="<And>");var j=e[b.relatedListColumn].attr("Type");i+="Lookup"===j?"<Eq><FieldRef Name='"+b.relatedListColumn+(b.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+J(f[0])+"</Value></Eq>":"<Eq><FieldRef Name='"+(b.matchOnId?"ID' /><Value Type='Counter'>":b.relatedListColumn+"'/><Value Type='Text'>")+J(f[0])+"</Value></Eq>",b.CAMLQuery.length>0&&(i+=b.CAMLQuery+"</And>"),i+="</Where></Query>";var k=" ";for(sb=0;sb<b.relatedColumns.length;sb++)k+="<FieldRef Name='"+b.relatedColumns[sb]+"' />";a().SPServices({operation:"GetListItems",async:!1,webURL:b.relatedWebURL,listName:b.relatedList,CAMLQuery:i,CAMLViewFields:"<ViewFields>"+k+"</ViewFields>",CAMLRowLimit:0,completefunc:function(f){a(f.responseXML).find("errorstring").each(function(){var c=a(this).text();b.debug&&"One or more field types are not installed properly. Go to the list settings page to delete these fields."===c?x(g,"relatedListColumn: "+b.relatedListColumn,"Column not found in relatedList "+b.relatedList):b.debug&&"Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."===c&&x(g,"relatedList: "+b.relatedList,"List not found")});var h;switch(b.displayFormat){case"table":for(h="<table>",h+="<tr>",sb=0;sb<b.relatedColumns.length;sb++){if("undefined"==typeof e[b.relatedColumns[sb]]&&b.debug)return void x(g,"columnName: "+b.relatedColumns[sb],"Column not found in relatedList");h+="<th class='"+b.headerCSSClass+"'>"+e[b.relatedColumns[sb]].attr("DisplayName")+"</th>"}h+="</tr>",a(f.responseXML).SPFilterNode("z:row").each(function(){for(h+="<tr>",sb=0;sb<b.relatedColumns.length;sb++)h+="<td class='"+b.rowCSSClass+"'>"+u(d,e[b.relatedColumns[sb]],a(this).attr("ows_"+b.relatedColumns[sb]),b)+"</td>";h+="</tr>"}),h+="</table>";break;case"list":h="<table>",a(f.responseXML).SPFilterNode("z:row").each(function(){for(sb=0;sb<b.relatedColumns.length;sb++){if("undefined"==typeof e[b.relatedColumns[sb]]&&b.debug)return void x(g,"columnName: "+b.relatedColumns[sb],"Column not found in relatedList");h+="<tr>",h+="<th class='"+b.headerCSSClass+"'>"+e[b.relatedColumns[sb]].attr("DisplayName")+"</th>",h+="<td class='"+b.rowCSSClass+"'>"+u(d,e[b.relatedColumns[sb]],a(this).attr("ows_"+b.relatedColumns[sb]),b)+"</td>",h+="</tr>"}}),h+="</table>"}a("#"+c).html(h)}}),null!==b.completefunc&&b.completefunc()}}function d(b,c,d,g,h){var i=0,j=0,k={};k.type=[],k.src=[],k.script=[];var l=RegExp("<script[\\s\\S]*?/script>","gi");a.ajax({type:"GET",url:h,dataType:"text",async:!1,success:function(m){for(var n;n=l.exec(m);){var o=e(n,"language"),p=e(n,"type"),q=e(n,"src");null!==q&&q.length>0&&!f(q)&&(k.type.push(null!==o&&o.length>0?o:p),k.src.push(q),j++)}if(!b.showNoScript&&k.type.length>0||b.showNoScript){var r=h.substring(0,h.lastIndexOf(O)+1),s="<tr class=ms-alternating><td class=ms-vb-icon><a href='"+c.attr("DefaultViewUrl")+"'><IMG border=0 src='"+c.attr("ImageUrl")+"'width=16 height=16></A></TD><td class=ms-vb2><a href='"+c.attr("DefaultViewUrl")+"'>"+c.attr("Title")+("True"===c.attr("Hidden")?"(Hidden)":"")+"</td><td class=ms-vb2>"+d+"</td><td class=ms-vb2>"+g+"</td><td class=ms-vb2><a href='"+h+"'>"+H(h)+"</td>";if(b.showSrc){var t;for(s+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>",i=0;i<k.type.length;i++)t=k.src[i].substr(0,1)!==O?r+k.src[i]:k.src[i],s+="<tr><td class=ms-vb2 width='30%'>"+k.type[i]+"</td>",s+="<td class=ms-vb2 width='70%'><a href='"+t+"'>"+H(k.src[i])+"</td></tr>";s+="</table></td>"}a("#SPScriptAudit").append(s)}}})}function e(a,b){var c,d=RegExp(b+"=(\"([^\"]*)\")|('([^']*)')","gi");return(c=d.exec(a))?c[2]:null}function f(a){var b,c=["WebResource.axd","_layouts"];for(b=0;b<c.length;b++)if(a.indexOf(c[b])>-1)return!0;return!1}function g(a,b){var c;switch(b){case"Text":c=h(a);break;case"DateTime":case"datetime":c=l(a);break;case"User":c=m(a);break;case"UserMulti":c=n(a);break;case"Lookup":c=o(a);break;case"LookupMulti":c=p(a);break;case"Boolean":c=k(a);break;case"Integer":c=i(a);break;case"Counter":c=i(a);break;case"MultiChoice":c=q(a);break;case"Number":case"Currency":case"float":c=j(a);break;case"Calculated":c=r(a);break;case"Attachments":c=o(a);break;case"JSON":c=s(a);break;default:c=h(a)}return c}function h(a){return a}function i(a){return parseInt(a,10)}function j(a){return parseFloat(a)}function k(a){var b="0"===a?!1:!0;return b}function l(a){var b=a.split(a.split("T")[0]!==a?"T":" "),c=b[0].split("-"),d=b[1].split(":"),e=d[2].split("Z"),f=new Date(c[0],c[1]-1,c[2],d[0],d[1],e[0]);return f}function m(a){if(0===a.length)return null;var b=new L(a),c=b.value.split(",#");return 1===c.length?{userId:b.id,userName:b.value}:{userId:b.id,userName:c[0].replace(/(,,)/g,","),loginName:c[1].replace(/(,,)/g,","),email:c[2].replace(/(,,)/g,","),sipAddress:c[3].replace(/(,,)/g,","),title:c[4].replace(/(,,)/g,",")}}function n(a){if(0===a.length)return null;var b=[],c=a.split(";#");for(sb=0;sb<c.length;sb+=2){var d=m(c[sb]+";#"+c[sb+1]);b.push(d)}return b}function o(a){if(0===a.length)return null;var b=new L(a);return{lookupId:b.id,lookupValue:b.value}}function p(a){if(0===a.length)return null;var b=[],c=a.split(";#");for(sb=0;sb<c.length;sb+=2){var d=o(c[sb]+";#"+c[sb+1]);b.push(d)}return b}function q(a){if(0===a.length)return null;var b=[],c=a.split(";#");for(sb=0;sb<c.length;sb++)0!==c[sb].length&&b.push(c[sb]);return b}function r(a){if(0===a.length)return null;var b=a.split(";#");return g(b[1],b[0])}function s(b){return 0===b.length?null:a.parseJSON(b)}function t(){"undefined"!=typeof _spPageContextInfo?(this.thisSite=_spPageContextInfo.webServerRelativeUrl,this.thisList=_spPageContextInfo.pageListId,this.thisUserId=_spPageContextInfo.userId):(this.thisSite="undefined"!=typeof L_Menu_BaseUrl?L_Menu_BaseUrl:"",this.thisList="",this.thisUserId="undefined"!=typeof _spUserId?_spUserId:void 0)}function u(b,c,d,e){if("undefined"==typeof d)return"";var f,g,h,i="",j=[],k=e.relatedWebURL.length>0?e.relatedWebURL:a().SPServices.SPGetCurrentSite();switch(c.attr("Type")){case"Text":i=d;break;case"URL":switch(c.attr("Format")){case"Hyperlink":i="<a href='"+d.substring(0,d.search(","))+"'>"+d.substring(d.search(",")+1)+"</a>";break;case"Image":i="<img alt='"+d.substring(d.search(",")+1)+"' src='"+d.substring(0,d.search(","))+"'/>";break;default:i=d}break;case"User":case"UserMulti":var l=d.split(";#");for(f=0;f<l.length;f+=2)j.push("<a href='/_layouts/userdisp.aspx?ID="+l[f]+"&Source="+K(location.href)+"'>"+l[f+1]+"</a>");i=j.join(", ");break;case"Calculated":var m=d.split(";#");i=m[1];break;case"Number":h=c.attr("Decimals"),i="undefined"==typeof h?parseFloat(d).toString():parseFloat(d).toFixed(h).toString();break;case"Currency":h=c.attr("Decimals"),i="undefined"==typeof h?parseFloat(d).toFixed(2).toString():parseFloat(d).toFixed(h).toString();break;case"Lookup":switch(c.attr("Name")){case"FileRef":g="1"===b.attr("BaseType")?b.attr("RootFolder")+O+"Forms/DispForm.aspx":b.attr("RootFolder")+O+"DispForm.aspx",i="<a href='"+g+"?ID="+d.substring(0,d.search(";#"))+"&RootFolder=*&Source="+K(location.href)+"'>"+d.substring(d.search(";#")+2)+"</a>";break;case"FileDirRef":g=O+d.substring(d.search(";#")+2),i="<a href='"+g+"'>"+d.substring(d.search(";#")+2)+"</a>";break;default:g=A(c.attr("List"),"DisplayForm"),i="<a href='"+e.relatedWebURL+O+g+"?ID="+d.substring(0,d.search(";#"))+"&RootFolder=*&Source="+K(location.href)+"'>"+d.substring(d.search(";#")+2)+"</a>"}break;case"LookupMulti":if(g=A(c.attr("List"),"DisplayForm"),i="",d.length>0){var n=d.split(";#");for(f=0;f<n.length/2;f++)j.push("<a href='"+k+O+g+"?ID="+n[2*f]+"&RootFolder=*&Source="+K(location.href)+"'>"+n[2*f+1]+"</a>")}i=j.join(", ");break;case"File":H=d.substring(d.search(";#")+2),i="<a href='"+b.attr("RootFolder")+O+H+"'>"+H+"</a>";break;case"Counter":i=d;break;case"DateTime":i=d;break;default:i=d}return i}function v(a){var b,c="<table class='ms-vb' width='100%'>";for(b=0;b<a.attributes.length;b++)c+="<tr><td width='10px' style='font-weight:bold;'>"+b+"</td><td width='100px'>"+a.attributes.item(b).nodeName+"</td><td>"+G(a.attributes.item(b).nodeValue)+"</td></tr>";return c+="</table>"}function w(b,c){var d=[];switch(b.Type){case T.simple:d.push(c?b.Obj.find("option:selected").val()||[]:b.Obj.find("option:selected").text()||[]);break;case T.complex:d.push(c?b.optHid.val()||[]:b.Obj.val()||[]);break;case T.multiSelect:a(b.master.resultControl).find("option").each(function(){d.push(c?a(this).val():a(this).html())})}return d}function x(a,b,c){var d="<b>Error in function</b><br/>"+a+"<br/><b>Parameter</b><br/>"+b+"<br/><b>Message</b><br/>"+c+"<br/><br/><span onmouseover='this.style.cursor=\"hand\";' onmouseout='this.style.cursor=\"inherit\";' style='width=100%;text-align:right;'>Click to continue</span></div>";y(d)}function y(b){var c="position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";a("#aspnetForm").parent().append("<div id='SPServices_msgBox' style="+c+">"+b);var d=a("#SPServices_msgBox").height(),e=a("#SPServices_msgBox").width(),f=a(window).width()/2-e/2+"px",g=a(window).height()/2-d/2-100+"px";a("#SPServices_msgBox").css({border:"5px #C02000 solid",left:f,top:g}).show().fadeTo("slow",.75).click(function(){a(this).fadeOut("3000",function(){a(this).remove()})})}function z(b,c){return b+"_"+a().SPServices.SPGetStaticFromDisplay({listName:a().SPServices.SPListNameFromUrl(),columnDisplayName:c})}function A(b,c){var d;return a().SPServices({operation:"GetFormCollection",async:!1,listName:b,completefunc:function(b){d=a(b.responseXML).find("Form[Type='"+c+"']").attr("Url")}}),d}function B(b,c){var d;for(d=0;d<c.length;d++)"string"==typeof c[d]?vb.payload+=E(c[d],b[c[d]]):a.isArray(c[d])&&2===c[d].length?vb.payload+=E(c[d][0],b[c[d][1]]):"object"==typeof c[d]&&void 0!==c[d].sendNull?vb.payload+=void 0===b[c[d].name]||0===b[c[d].name].length?"":E(c[d].name,b[c[d].name]):x(b.operation,"paramArray["+d+"]: "+c[d],"Invalid paramArray element passed to addToPayload()")}function C(b){var c,d=RegExp('FieldName="'+b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+'"',"gi");return a("td.ms-formbody, td.ms-formbodysurvey").each(function(){return d.test(a(this).html())?(c=a(this),!1):void 0}),c}function D(a,b){var c=b.substring(8);return a.opheader=a.opheader.replace(b,c),a.opfooter=a.opfooter.replace(b,c),a}function E(a,b){var c="undefined"!=typeof b?b:"";return"<"+a+">"+c+"</"+a+">"}function F(){return Math.round(Math.random())-.5}function G(a){return 0===a.indexOf("http")||0===a.indexOf(O)?"<a href='"+a+"'>"+a+"</a>":a}function H(a){return a.substring(a.lastIndexOf(O)+1,a.length)}function I(a){return a.replace(/([\&"<>])/g,function(a,b){return xb[b]})}function J(a){return"string"==typeof a?a.replace(/&(?![a-zA-Z]{1,8};)/g,"&amp;"):a}function K(a){return a.replace(/&/g,"%26")}function L(a){var b=a.split(";#");this.id=b[0],this.value=b[1]}function M(a){return 10>a?"0"+a:a}var N="2014.02a",O="/",P="Column not found on page",Q="http://schemas.microsoft.com/sharepoint",R="MultiLookupPicker",S="MultiLookup",T={simple:"S",complex:"C",multiSelect:"M"},U=["Text","DateTime","datetime","User","UserMulti","Lookup","LookupMulti","Boolean","Integer","Counter","MultiChoice","Currency","float","Calc","Attachments","Calculated","ContentTypeId","Note","URL","Number","Choice","ModStat","Guid","File"],V={},W="Alerts",X="Authentication",Y="Copy",Z="Forms",$="Lists",_="Meetings",ab="People",bb="Permissions",cb="PublishedLinksService",db="Search",eb="SharePointDiagnostics",fb="SiteData",gb="Sites",hb="SocialDataService",ib="SpellCheck",jb="TaxonomyClientService",kb="usergroup",lb="UserProfileService",mb="Versions",nb="Views",ob="WebPartPages",pb="Webs",qb="Workflow",rb=new t,sb=0,tb=["listName","description"],ub=[];ub.GetAlerts=[W,!1],ub.DeleteAlerts=[W,!0],ub.Mode=[X,!1],ub.Login=[X,!1],ub.CopyIntoItems=[Y,!0],ub.CopyIntoItemsLocal=[Y,!0],ub.GetItem=[Y,!1],ub.GetForm=[Z,!1],ub.GetFormCollection=[Z,!1],ub.AddAttachment=[$,!0],ub.AddDiscussionBoardItem=[$,!0],ub.AddList=[$,!0],ub.AddListFromFeature=[$,!0],ub.ApplyContentTypeToList=[$,!0],ub.CheckInFile=[$,!0],ub.CheckOutFile=[$,!0],ub.CreateContentType=[$,!0],ub.DeleteAttachment=[$,!0],ub.DeleteContentType=[$,!0],ub.DeleteContentTypeXmlDocument=[$,!0],ub.DeleteList=[$,!0],ub.GetAttachmentCollection=[$,!1],ub.GetList=[$,!1],ub.GetListAndView=[$,!1],ub.GetListCollection=[$,!1],ub.GetListContentType=[$,!1],ub.GetListContentTypes=[$,!1],ub.GetListItemChanges=[$,!1],ub.GetListItemChangesSinceToken=[$,!1],ub.GetListItems=[$,!1],ub.GetVersionCollection=[$,!1],ub.UndoCheckOut=[$,!0],ub.UpdateContentType=[$,!0],ub.UpdateContentTypesXmlDocument=[$,!0],ub.UpdateContentTypeXmlDocument=[$,!0],ub.UpdateList=[$,!0],ub.UpdateListItems=[$,!0],ub.AddMeeting=[_,!0],ub.CreateWorkspace=[_,!0],ub.RemoveMeeting=[_,!0],ub.SetWorkSpaceTitle=[_,!0],ub.ResolvePrincipals=[ab,!1],ub.SearchPrincipals=[ab,!1],ub.AddPermission=[bb,!0],ub.AddPermissionCollection=[bb,!0],ub.GetPermissionCollection=[bb,!0],ub.RemovePermission=[bb,!0],ub.RemovePermissionCollection=[bb,!0],ub.UpdatePermission=[bb,!0],ub.GetLinks=[cb,!0],ub.GetPortalSearchInfo=[db,!1],ub.GetQuerySuggestions=[db,!1],ub.GetSearchMetadata=[db,!1],ub.Query=[db,!1],ub.QueryEx=[db,!1],ub.Registration=[db,!1],ub.Status=[db,!1],ub.SendClientScriptErrorReport=[eb,!0],ub.GetAttachments=[fb,!1],ub.EnumerateFolder=[fb,!1],ub.SiteDataGetList=[fb,!1],ub.SiteDataGetListCollection=[fb,!1],ub.SiteDataGetSite=[fb,!1],ub.SiteDataGetSiteUrl=[fb,!1],ub.SiteDataGetWeb=[fb,!1],ub.CreateWeb=[gb,!0],ub.DeleteWeb=[gb,!0],ub.GetSite=[gb,!1],ub.GetSiteTemplates=[gb,!1],ub.AddComment=[hb,!0],ub.AddTag=[hb,!0],ub.AddTagByKeyword=[hb,!0],ub.CountCommentsOfUser=[hb,!1],ub.CountCommentsOfUserOnUrl=[hb,!1],ub.CountCommentsOnUrl=[hb,!1],ub.CountRatingsOnUrl=[hb,!1],ub.CountTagsOfUser=[hb,!1],ub.DeleteComment=[hb,!0],ub.DeleteRating=[hb,!0],ub.DeleteTag=[hb,!0],ub.DeleteTagByKeyword=[hb,!0],ub.DeleteTags=[hb,!0],ub.GetAllTagTerms=[hb,!1],ub.GetAllTagTermsForUrlFolder=[hb,!1],ub.GetAllTagUrls=[hb,!1],ub.GetAllTagUrlsByKeyword=[hb,!1],ub.GetCommentsOfUser=[hb,!1],ub.GetCommentsOfUserOnUrl=[hb,!1],ub.GetCommentsOnUrl=[hb,!1],ub.GetRatingAverageOnUrl=[hb,!1],ub.GetRatingOfUserOnUrl=[hb,!1],ub.GetRatingOnUrl=[hb,!1],ub.GetRatingsOfUser=[hb,!1],ub.GetRatingsOnUrl=[hb,!1],ub.GetSocialDataForFullReplication=[hb,!1],ub.GetTags=[hb,!0],ub.GetTagsOfUser=[hb,!0],ub.GetTagTerms=[hb,!0],ub.GetTagTermsOfUser=[hb,!0],ub.GetTagTermsOnUrl=[hb,!0],ub.GetTagUrlsOfUser=[hb,!0],ub.GetTagUrlsOfUserByKeyword=[hb,!0],ub.GetTagUrls=[hb,!0],ub.GetTagUrlsByKeyword=[hb,!0],ub.SetRating=[hb,!0],ub.UpdateComment=[hb,!0],ub.SpellCheck=[ib,!1],ub.AddTerms=[jb,!0],ub.GetChildTermsInTerm=[jb,!1],ub.GetChildTermsInTermSet=[jb,!1],ub.GetKeywordTermsByGuids=[jb,!1],ub.GetTermsByLabel=[jb,!1],ub.GetTermSets=[jb,!1],ub.AddGroup=[kb,!0],ub.AddGroupToRole=[kb,!0],ub.AddRole=[kb,!0],ub.AddRoleDef=[kb,!0],ub.AddUserCollectionToGroup=[kb,!0],ub.AddUserCollectionToRole=[kb,!0],ub.AddUserToGroup=[kb,!0],ub.AddUserToRole=[kb,!0],ub.GetAllUserCollectionFromWeb=[kb,!1],ub.GetGroupCollection=[kb,!1],ub.GetGroupCollectionFromRole=[kb,!1],ub.GetGroupCollectionFromSite=[kb,!1],ub.GetGroupCollectionFromUser=[kb,!1],ub.GetGroupCollectionFromWeb=[kb,!1],ub.GetGroupInfo=[kb,!1],ub.GetRoleCollection=[kb,!1],ub.GetRoleCollectionFromGroup=[kb,!1],ub.GetRoleCollectionFromUser=[kb,!1],ub.GetRoleCollectionFromWeb=[kb,!1],ub.GetRoleInfo=[kb,!1],ub.GetRolesAndPermissionsForCurrentUser=[kb,!1],ub.GetRolesAndPermissionsForSite=[kb,!1],ub.GetUserCollection=[kb,!1],ub.GetUserCollectionFromGroup=[kb,!1],ub.GetUserCollectionFromRole=[kb,!1],ub.GetUserCollectionFromSite=[kb,!1],ub.GetUserCollectionFromWeb=[kb,!1],ub.GetUserInfo=[kb,!1],ub.GetUserLoginFromEmail=[kb,!1],ub.RemoveGroup=[kb,!0],ub.RemoveGroupFromRole=[kb,!0],ub.RemoveRole=[kb,!0],ub.RemoveUserCollectionFromGroup=[kb,!0],ub.RemoveUserCollectionFromRole=[kb,!0],ub.RemoveUserCollectionFromSite=[kb,!0],ub.RemoveUserFromGroup=[kb,!0],ub.RemoveUserFromRole=[kb,!0],ub.RemoveUserFromSite=[kb,!0],ub.RemoveUserFromWeb=[kb,!0],ub.UpdateGroupInfo=[kb,!0],ub.UpdateRoleDefInfo=[kb,!0],ub.UpdateRoleInfo=[kb,!0],ub.UpdateUserInfo=[kb,!0],ub.AddColleague=[lb,!0],ub.AddLink=[lb,!0],ub.AddMembership=[lb,!0],ub.AddPinnedLink=[lb,!0],ub.CreateMemberGroup=[lb,!0],ub.CreateUserProfileByAccountName=[lb,!0],ub.GetCommonColleagues=[lb,!1],ub.GetCommonManager=[lb,!1],ub.GetCommonMemberships=[lb,!1],ub.GetInCommon=[lb,!1],ub.GetPropertyChoiceList=[lb,!1],ub.GetUserColleagues=[lb,!1],ub.GetUserLinks=[lb,!1],ub.GetUserMemberships=[lb,!1],ub.GetUserPinnedLinks=[lb,!1],ub.GetUserProfileByGuid=[lb,!1],ub.GetUserProfileByIndex=[lb,!1],ub.GetUserProfileByName=[lb,!1],ub.GetUserProfileCount=[lb,!1],ub.GetUserProfileSchema=[lb,!1],ub.GetUserPropertyByAccountName=[lb,!1],ub.ModifyUserPropertyByAccountName=[lb,!0],ub.RemoveAllColleagues=[lb,!0],ub.RemoveAllLinks=[lb,!0],ub.RemoveAllMemberships=[lb,!0],ub.RemoveAllPinnedLinks=[lb,!0],ub.RemoveColleague=[lb,!0],ub.RemoveLink=[lb,!0],ub.RemoveMembership=[lb,!0],ub.RemovePinnedLink=[lb,!0],ub.UpdateColleaguePrivacy=[lb,!0],ub.UpdateLink=[lb,!0],ub.UpdateMembershipPrivacy=[lb,!0],ub.UpdatePinnedLink=[lb,!0],ub.DeleteAllVersions=[mb,!0],ub.DeleteVersion=[mb,!0],ub.GetVersions=[mb,!1],ub.RestoreVersion=[mb,!0],ub.AddView=[nb,!0],ub.DeleteView=[nb,!0],ub.GetView=[nb,!1],ub.GetViewHtml=[nb,!1],ub.GetViewCollection=[nb,!1],ub.UpdateView=[nb,!0],ub.UpdateViewHtml=[nb,!0],ub.AddWebPart=[ob,!0],ub.AddWebPartToZone=[ob,!0],ub.GetWebPart2=[ob,!1],ub.GetWebPartPage=[ob,!1],ub.GetWebPartProperties=[ob,!1],ub.GetWebPartProperties2=[ob,!1],ub.CreateContentType=[pb,!0],ub.GetColumns=[pb,!1],ub.GetContentType=[pb,!1],ub.GetContentTypes=[pb,!1],ub.GetCustomizedPageStatus=[pb,!1],ub.GetListTemplates=[pb,!1],ub.GetObjectIdFromUrl=[pb,!1],ub.GetWeb=[pb,!1],ub.GetWebCollection=[pb,!1],ub.GetAllSubWebCollection=[pb,!1],ub.UpdateColumns=[pb,!0],ub.UpdateContentType=[pb,!0],ub.WebUrlFromPageUrl=[pb,!1],ub.AlterToDo=[qb,!0],ub.ClaimReleaseTask=[qb,!0],ub.GetTemplatesForItem=[qb,!1],ub.GetToDosForItem=[qb,!1],ub.GetWorkflowDataForItem=[qb,!1],ub.GetWorkflowTaskData=[qb,!1],ub.StartWorkflow=[qb,!0];var vb={};vb.header="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>",vb.footer="</soap:Body></soap:Envelope>",vb.payload="";var wb;a.fn.SPServices=function(b){for(var c=a.extend({},a.fn.SPServices.defaults,b),d=0;d<tb.length;d++)"string"==typeof c[tb[d]]&&(c[tb[d]]=I(c[tb[d]]));switch(vb.opheader="<"+c.operation+" ",ub[c.operation][0]){case W:vb.opheader+="xmlns='"+Q+"/soap/2002/1/alerts/' >",wb=Q+"/soap/2002/1/alerts/";break;case _:vb.opheader+="xmlns='"+Q+"/soap/meetings/' >",wb=Q+"/soap/meetings/";break;case bb:vb.opheader+="xmlns='"+Q+"/soap/directory/' >",wb=Q+"/soap/directory/";break;case cb:vb.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >",wb="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case db:vb.opheader+="xmlns='urn:Microsoft.Search' >",wb="urn:Microsoft.Search/";break;case eb:vb.opheader+="xmlns='"+Q+"/diagnostics/' >",wb="http://schemas.microsoft.com/sharepoint/diagnostics/";break;case hb:vb.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService' >",wb="http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/";break;case ib:vb.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/publishing/spelling/' >",wb="http://schemas.microsoft.com/sharepoint/publishing/spelling/SpellCheck";break;case jb:vb.opheader+="xmlns='"+Q+"/taxonomy/soap/' >",wb=Q+"/taxonomy/soap/";break;case kb:vb.opheader+="xmlns='"+Q+"/soap/directory/' >",wb=Q+"/soap/directory/";break;case lb:vb.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >",wb="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case ob:vb.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >",wb="http://microsoft.com/sharepoint/webpartpages/";break;case qb:vb.opheader+="xmlns='"+Q+"/soap/workflow/' >",wb=Q+"/soap/workflow/";break;default:vb.opheader+="xmlns='"+Q+"/soap/'>",wb=Q+"/soap/"}wb+=c.operation,vb.opfooter="</"+c.operation+">";var e="_vti_bin/"+ub[c.operation][0]+".asmx";if(c.webURL.charAt(c.webURL.length-1)===O)e=c.webURL+e;else if(c.webURL.length>0)e=c.webURL+O+e;else{var f=a().SPServices.SPGetCurrentSite();e=f+(f.charAt(f.length-1)===O?e:O+e)}switch(vb.payload="",c.operation){case"GetAlerts":break;case"DeleteAlerts":for(vb.payload+="<IDs>",d=0;d<c.IDs.length;d++)vb.payload+=E("string",c.IDs[d]);vb.payload+="</IDs>";break;case"Mode":break;case"Login":B(c,["username","password"]);break;case"CopyIntoItems":for(B(c,["SourceUrl"]),vb.payload+="<DestinationUrls>",d=0;d<c.DestinationUrls.length;d++)vb.payload+=E("string",c.DestinationUrls[d]);vb.payload+="</DestinationUrls>",B(c,["Fields","Stream","Results"]);break;case"CopyIntoItemsLocal":for(B(c,["SourceUrl"]),vb.payload+="<DestinationUrls>",d=0;d<c.DestinationUrls.length;d++)vb.payload+=E("string",c.DestinationUrls[d]);vb.payload+="</DestinationUrls>";break;case"GetItem":B(c,["Url","Fields","Stream"]);break;case"GetForm":B(c,["listName","formUrl"]);break;case"GetFormCollection":B(c,["listName"]);break;case"AddAttachment":B(c,["listName","listItemID","fileName","attachment"]);break;case"AddDiscussionBoardItem":B(c,["listName","message"]);break;case"AddList":B(c,["listName","description","templateID"]);break;case"AddListFromFeature":B(c,["listName","description","featureID","templateID"]);break;case"ApplyContentTypeToList":B(c,["webUrl","contentTypeId","listName"]);break;case"CheckInFile":B(c,["pageUrl","comment","CheckinType"]);break;case"CheckOutFile":B(c,["pageUrl","checkoutToLocal","lastmodified"]);break;case"CreateContentType":B(c,["listName","displayName","parentType","fields","contentTypeProperties","addToView"]);break;case"DeleteAttachment":B(c,["listName","listItemID","url"]);break;case"DeleteContentType":B(c,["listName","contentTypeId"]);break;case"DeleteContentTypeXmlDocument":B(c,["listName","contentTypeId","documentUri"]);break;case"DeleteList":B(c,["listName"]);break;case"GetAttachmentCollection":B(c,["listName",["listItemID","ID"]]);break;case"GetList":B(c,["listName"]);break;case"GetListAndView":B(c,["listName","viewName"]);break;case"GetListCollection":break;case"GetListContentType":B(c,["listName","contentTypeId"]);break;case"GetListContentTypes":B(c,["listName"]);break;case"GetListItems":B(c,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"]]);break;case"GetListItemChanges":B(c,["listName","viewFields","since","contains"]);break;case"GetListItemChangesSinceToken":B(c,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"],{name:"changeToken",sendNull:!1},{name:"contains",sendNull:!1}]);break;case"GetVersionCollection":B(c,["strlistID","strlistItemID","strFieldName"]);break;case"UndoCheckOut":B(c,["pageUrl"]);break;case"UpdateContentType":B(c,["listName","contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields","addToView"]);break;case"UpdateContentTypesXmlDocument":B(c,["listName","newDocument"]);break;case"UpdateContentTypeXmlDocument":B(c,["listName","contentTypeId","newDocument"]);break;case"UpdateList":B(c,["listName","listProperties","newFields","updateFields","deleteFields","listVersion"]);break;case"UpdateListItems":if(B(c,["listName"]),"undefined"!=typeof c.updates&&c.updates.length>0)B(c,["updates"]);else{for(vb.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+c.batchCmd+"'>",d=0;d<c.valuepairs.length;d++)vb.payload+="<Field Name='"+c.valuepairs[d][0]+"'>"+J(c.valuepairs[d][1])+"</Field>";"New"!==c.batchCmd&&(vb.payload+="<Field Name='ID'>"+c.ID+"</Field>"),vb.payload+="</Method></Batch></updates>"}break;case"AddMeeting":B(c,["organizerEmail","uid","sequence","utcDateStamp","title","location","utcDateStart","utcDateEnd","nonGregorian"]);break;case"CreateWorkspace":B(c,["title","templateName","lcid","timeZoneInformation"]);break;case"RemoveMeeting":B(c,["recurrenceId","uid","sequence","utcDateStamp","cancelMeeting"]);break;case"SetWorkspaceTitle":B(c,["title"]);break;case"ResolvePrincipals":B(c,["principalKeys","principalType","addToUserInfoList"]);break;case"SearchPrincipals":B(c,["searchText","maxResults","principalType"]);break;case"AddPermission":B(c,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"AddPermissionCollection":B(c,["objectName","objectType","permissionsInfoXml"]);break;case"GetPermissionCollection":B(c,["objectName","objectType"]);break;case"RemovePermission":B(c,["objectName","objectType","permissionIdentifier","permissionType"]);break;case"RemovePermissionCollection":B(c,["objectName","objectType","memberIdsXml"]);break;case"UpdatePermission":B(c,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"GetLinks":break;case"GetPortalSearchInfo":vb.opheader="<"+c.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",wb="http://microsoft.com/webservices/OfficeServer/QueryService/"+c.operation;break;case"GetQuerySuggestions":vb.opheader="<"+c.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",wb="http://microsoft.com/webservices/OfficeServer/QueryService/"+c.operation,vb.payload+=E("queryXml",I(c.queryXml));break;case"GetSearchMetadata":vb.opheader="<"+c.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",wb="http://microsoft.com/webservices/OfficeServer/QueryService/"+c.operation;break;case"Query":vb.payload+=E("queryXml",I(c.queryXml));break;case"QueryEx":vb.opheader="<"+c.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",wb="http://microsoft.com/webservices/OfficeServer/QueryService/"+c.operation,vb.payload+=E("queryXml",I(c.queryXml));break;case"Registration":vb.payload+=E("registrationXml",I(c.registrationXml));break;case"Status":break;case"SendClientScriptErrorReport":B(c,["message","file","line","client","stack","team","originalFile"]);break;case"EnumerateFolder":B(c,["strFolderUrl"]);break;case"GetAttachments":B(c,["strListName","strItemId"]);break;case"SiteDataGetList":B(c,["strListName"]),vb=D(vb,c.operation);break;case"SiteDataGetListCollection":vb=D(vb,c.operation);break;case"SiteDataGetSite":vb=D(vb,c.operation);break;case"SiteDataGetSiteUrl":B(c,["Url"]),vb=D(vb,c.operation);break;case"SiteDataGetWeb":vb=D(vb,c.operation);break;case"CreateWeb":B(c,["url","title","description","templateName","language","languageSpecified","locale","localeSpecified","collationLocale","collationLocaleSpecified","uniquePermissions","uniquePermissionsSpecified","anonymous","anonymousSpecified","presence","presenceSpecified"]);break;case"DeleteWeb":B(c,["url"]);break;case"GetSite":B(c,["SiteUrl"]);break;case"GetSiteTemplates":B(c,["LCID","TemplateList"]);
break;case"AddComment":B(c,["url","comment","isHighPriority","title"]);break;case"AddTag":B(c,["url","termID","title","isPrivate"]);break;case"AddTagByKeyword":B(c,["url","keyword","title","isPrivate"]);break;case"CountCommentsOfUser":B(c,["userAccountName"]);break;case"CountCommentsOfUserOnUrl":B(c,["userAccountName","url"]);break;case"CountCommentsOnUrl":B(c,["url"]);break;case"CountRatingsOnUrl":B(c,["url"]);break;case"CountTagsOfUser":B(c,["userAccountName"]);break;case"DeleteComment":B(c,["url","lastModifiedTime"]);break;case"DeleteRating":B(c,["url"]);break;case"DeleteTag":B(c,["url","termID"]);break;case"DeleteTagByKeyword":B(c,["url","keyword"]);break;case"DeleteTags":B(c,["url"]);break;case"GetAllTagTerms":B(c,["maximumItemsToReturn"]);break;case"GetAllTagTermsForUrlFolder":B(c,["urlFolder","maximumItemsToReturn"]);break;case"GetAllTagUrls":B(c,["termID"]);break;case"GetAllTagUrlsByKeyword":B(c,["keyword"]);break;case"GetCommentsOfUser":B(c,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetCommentsOfUserOnUrl":B(c,["userAccountName","url"]);break;case"GetCommentsOnUrl":B(c,["url","maximumItemsToReturn","startIndex"]),"undefined"!=typeof c.excludeItemsTime&&c.excludeItemsTime.length>0&&(vb.payload+=E("excludeItemsTime",c.excludeItemsTime));break;case"GetRatingAverageOnUrl":B(c,["url"]);break;case"GetRatingOfUserOnUrl":B(c,["userAccountName","url"]);break;case"GetRatingOnUrl":B(c,["url"]);break;case"GetRatingsOfUser":B(c,["userAccountName"]);break;case"GetRatingsOnUrl":B(c,["url"]);break;case"GetSocialDataForFullReplication":B(c,["userAccountName"]);break;case"GetTags":B(c,["url"]);break;case"GetTagsOfUser":B(c,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetTagTerms":B(c,["maximumItemsToReturn"]);break;case"GetTagTermsOfUser":B(c,["userAccountName","maximumItemsToReturn"]);break;case"GetTagTermsOnUrl":B(c,["url","maximumItemsToReturn"]);break;case"GetTagUrls":B(c,["termID"]);break;case"GetTagUrlsByKeyword":B(c,["keyword"]);break;case"GetTagUrlsOfUser":B(c,["termID","userAccountName"]);break;case"GetTagUrlsOfUserByKeyword":B(c,["keyword","userAccountName"]);break;case"SetRating":B(c,["url","rating","title","analysisDataEntry"]);break;case"UpdateComment":B(c,["url","lastModifiedTime","comment","isHighPriority"]);break;case"SpellCheck":B(c,["chunksToSpell","declaredLanguage","useLad"]);break;case"AddTerms":B(c,["sharedServiceId","termSetId","lcid","newTerms"]);break;case"GetChildTermsInTerm":B(c,["sspId","lcid","termId","termSetId"]);break;case"GetChildTermsInTermSet":B(c,["sspId","lcid","termSetId"]);break;case"GetKeywordTermsByGuids":B(c,["termIds","lcid"]);break;case"GetTermsByLabel":B(c,["label","lcid","matchOption","resultCollectionSize","termIds","addIfNotFound"]);break;case"GetTermSets":B(c,["sharedServiceId","termSetId","lcid","clientTimeStamps","clientVersions"]);break;case"AddGroup":B(c,["groupName","ownerIdentifier","ownerType","defaultUserLoginName","description"]);break;case"AddGroupToRole":B(c,["groupName","roleName"]);break;case"AddRole":B(c,["roleName","description","permissionMask"]);break;case"AddRoleDef":B(c,["roleName","description","permissionMask"]);break;case"AddUserCollectionToGroup":B(c,["groupName","usersInfoXml"]);break;case"AddUserCollectionToRole":B(c,["roleName","usersInfoXml"]);break;case"AddUserToGroup":B(c,["groupName","userName","userLoginName","userEmail","userNotes"]);break;case"AddUserToRole":B(c,["roleName","userName","userLoginName","userEmail","userNotes"]);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollection":B(c,["groupNamesXml"]);break;case"GetGroupCollectionFromRole":B(c,["roleName"]);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":B(c,["userLoginName"]);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":B(c,["groupName"]);break;case"GetRoleCollection":B(c,["roleNamesXml"]);break;case"GetRoleCollectionFromGroup":B(c,["groupName"]);break;case"GetRoleCollectionFromUser":B(c,["userLoginName"]);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":B(c,["roleName"]);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":B(c,["userLoginNamesXml"]);break;case"GetUserCollectionFromGroup":B(c,["groupName"]);break;case"GetUserCollectionFromRole":B(c,["roleName"]);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":B(c,["userLoginName"]);break;case"GetUserLoginFromEmail":B(c,["emailXml"]);break;case"RemoveGroup":B(c,["groupName"]);break;case"RemoveGroupFromRole":B(c,["roleName","groupName"]);break;case"RemoveRole":B(c,["roleName"]);break;case"RemoveUserCollectionFromGroup":B(c,["groupName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromRole":B(c,["roleName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromSite":B(c,["userLoginNamesXml"]);break;case"RemoveUserFromGroup":B(c,["groupName","userLoginName"]);break;case"RemoveUserFromRole":B(c,["roleName","userLoginName"]);break;case"RemoveUserFromSite":B(c,["userLoginName"]);break;case"RemoveUserFromWeb":B(c,["userLoginName"]);break;case"UpdateGroupInfo":B(c,["oldGroupName","groupName","ownerIdentifier","ownerType","description"]);break;case"UpdateRoleDefInfo":B(c,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateRoleInfo":B(c,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateUserInfo":B(c,["userLoginName","userName","userEmail","userNotes"]);break;case"AddColleague":B(c,["accountName","colleagueAccountName","group","privacy","isInWorkGroup"]);break;case"AddLink":B(c,["accountName","name","url","group","privacy"]);break;case"AddMembership":B(c,["accountName","membershipInfo","group","privacy"]);break;case"AddPinnedLink":B(c,["accountName","name","url"]);break;case"CreateMemberGroup":B(c,["membershipInfo"]);break;case"CreateUserProfileByAccountName":B(c,["accountName"]);break;case"GetCommonColleagues":B(c,["accountName"]);break;case"GetCommonManager":B(c,["accountName"]);break;case"GetCommonMemberships":B(c,["accountName"]);break;case"GetInCommon":B(c,["accountName"]);break;case"GetPropertyChoiceList":B(c,["propertyName"]);break;case"GetUserColleagues":B(c,["accountName"]);break;case"GetUserLinks":B(c,["accountName"]);break;case"GetUserMemberships":B(c,["accountName"]);break;case"GetUserPinnedLinks":B(c,["accountName"]);break;case"GetUserProfileByGuid":B(c,["guid"]);break;case"GetUserProfileByIndex":B(c,["index"]);break;case"GetUserProfileByName":"undefined"!=typeof c.accountName&&c.accountName.length>0?B(c,[["AccountName","accountName"]]):B(c,["AccountName"]);break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"GetUserPropertyByAccountName":B(c,["accountName","propertyName"]);break;case"ModifyUserPropertyByAccountName":B(c,["accountName","newData"]);break;case"RemoveAllColleagues":B(c,["accountName"]);break;case"RemoveAllLinks":B(c,["accountName"]);break;case"RemoveAllMemberships":B(c,["accountName"]);break;case"RemoveAllPinnedLinks":B(c,["accountName"]);break;case"RemoveColleague":B(c,["accountName","colleagueAccountName"]);break;case"RemoveLink":B(c,["accountName","id"]);break;case"RemoveMembership":B(c,["accountName","sourceInternal","sourceReference"]);break;case"RemovePinnedLink":B(c,["accountName","id"]);break;case"UpdateColleaguePrivacy":B(c,["accountName","colleagueAccountName","newPrivacy"]);break;case"UpdateLink":B(c,["accountName","data"]);break;case"UpdateMembershipPrivacy":B(c,["accountName","sourceInternal","sourceReference","newPrivacy"]);break;case"UpdatePinnedLink ":B(c,["accountName","data"]);break;case"DeleteAllVersions":B(c,["fileName"]);break;case"DeleteVersion":B(c,["fileName","fileVersion"]);break;case"GetVersions":B(c,["fileName"]);break;case"RestoreVersion":B(c,["fileName","fileVersion"]);break;case"AddView":B(c,["listName","viewName","viewFields","query","rowLimit","rowLimit","type","makeViewDefault"]);break;case"DeleteView":B(c,["listName","viewName"]);break;case"GetView":B(c,["listName","viewName"]);break;case"GetViewCollection":B(c,["listName"]);break;case"GetViewHtml":B(c,["listName","viewName"]);break;case"UpdateView":B(c,["listName","viewName","viewProperties","query","viewFields","aggregations","formats","rowLimit"]);break;case"UpdateViewHtml":B(c,["listName","viewName","viewProperties","toolbar","viewHeader","viewBody","viewFooter","viewEmpty","rowLimitExceeded","query","viewFields","aggregations","formats","rowLimit"]);break;case"AddWebPart":B(c,["pageUrl","webPartXml","storage"]);break;case"AddWebPartToZone":B(c,["pageUrl","webPartXml","storage","zoneId","zoneIndex"]);break;case"GetWebPart2":B(c,["pageUrl","storageKey","storage","behavior"]);break;case"GetWebPartPage":B(c,["documentName","behavior"]);break;case"GetWebPartProperties":B(c,["pageUrl","storage"]);break;case"GetWebPartProperties2":B(c,["pageUrl","storage","behavior"]);break;case"Webs.CreateContentType":B(c,["displayName","parentType","newFields","contentTypeProperties"]);break;case"GetColumns":B(c,["webUrl"]);break;case"GetContentType":B(c,["contentTypeId"]);break;case"GetContentTypes":break;case"GetCustomizedPageStatus":B(c,["fileUrl"]);break;case"GetListTemplates":break;case"GetObjectIdFromUrl":B(c,["objectUrl"]);break;case"GetWeb":B(c,[["webUrl","webURL"]]);break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"UpdateColumns":B(c,["newFields","updateFields","deleteFields"]);break;case"Webs.UpdateContentType":B(c,["contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields"]);break;case"WebUrlFromPageUrl":B(c,[["pageUrl","pageURL"]]);break;case"AlterToDo":B(c,["item","todoId","todoListId","taskData"]);break;case"ClaimReleaseTask":B(c,["item","taskId","listId","fClaim"]);break;case"GetTemplatesForItem":B(c,["item"]);break;case"GetToDosForItem":B(c,["item"]);break;case"GetWorkflowDataForItem":B(c,["item"]);break;case"GetWorkflowTaskData":B(c,["item","listId","taskId"]);break;case"StartWorkflow":B(c,["item","templateId","workflowParameters"])}var g,h=vb.header+vb.opheader+vb.payload+vb.opfooter+vb.footer;return c.cacheXML&&(g=V[h]),"undefined"==typeof g?(V[h]=a.ajax({url:e,async:c.async,beforeSend:function(a){ub[c.operation][1]&&a.setRequestHeader("SOAPAction",wb)},type:"POST",data:h,dataType:"xml",contentType:"text/xml;charset='utf-8'",complete:function(b,d){a.isFunction(c.completefunc)&&c.completefunc(b,d)}}),V[h]):(a.isFunction(c.completefunc)&&c.completefunc(g,null),g)},a.fn.SPServices.defaults={cacheXML:!1,operation:"",webURL:"",makeViewDefault:!1,CAMLViewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuepairs:[],DestinationUrls:[],behavior:"Version3",storage:"Shared",objectType:"List",cancelMeeting:!0,nonGregorian:!1,fClaim:!1,recurrenceId:0,sequence:0,maximumItemsToReturn:0,startIndex:0,isHighPriority:!1,isPrivate:!1,rating:1,maxResults:10,principalType:"User",async:!0,completefunc:null},a.fn.SPServices.SPGetCurrentSite=function(){if(rb.thisSite.length>0)return rb.thisSite;var b=vb.header+"<WebUrlFromPageUrl xmlns='"+Q+"/soap/' ><pageUrl>"+(location.href.indexOf("?")>0?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+vb.footer;return a.ajax({async:!1,url:"/_vti_bin/Webs.asmx",type:"POST",data:b,dataType:"xml",contentType:'text/xml;charset="utf-8"',complete:function(b){rb.thisSite=a(b.responseXML).find("WebUrlFromPageUrlResult").text()}}),rb.thisSite},a.fn.SPServices.SPCascadeDropdowns=function(c){var d=a.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListParentColumn:"",relationshipListChildColumn:"",relationshipListSortColumn:"",parentColumn:"",childColumn:"",listName:a().SPServices.SPListNameFromUrl(),CAMLQuery:"",CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns></QueryOptions>",promptText:"",noneText:"(None)",simpleChild:!1,selectSingleOption:!1,matchOnId:!1,completefunc:null,debug:!1},c),e=!1,f="SPServices.SPCascadeDropdowns",g=a().SPServices.SPDropdownCtl({displayName:d.parentColumn});if(null===g.Obj.html()&&d.debug)return void x(f,"parentColumn: "+d.parentColumn,P);var h=a().SPServices.SPDropdownCtl({displayName:d.childColumn});if(null===h.Obj.html()&&d.debug)return void x(f,"childColumn: "+d.childColumn,P);d.simpleChild===!0&&h.Type===T.complex&&(a().SPServices.SPComplexToSimpleDropdown({columnName:d.childColumn}),h=a().SPServices.SPDropdownCtl({displayName:d.childColumn}));var i,j;a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:d.listName,completefunc:function(b){a(b.responseXML).find("Fields").each(function(){a(this).find("Field[DisplayName='"+d.childColumn+"']").each(function(){return i="TRUE"===a(this).attr("Required")?!0:!1,j=a(this).attr("StaticName"),!1})})}});var k={opt:d,childSelect:h,childColumnStatic:j,childColumnRequired:i},l=g.Obj.data("SPCascadeDropdownsChildColumns");if("undefined"==typeof l?g.Obj.data("SPCascadeDropdownsChildColumns",[k]):(l.push(k),g.Obj.data("SPCascadeDropdownsChildColumns",l),e=!0),!e)switch(g.Type){case T.simple:g.Obj.bind("change",function(){b(d.parentColumn,g)});break;case T.complex:g.optHid.bind("propertychange",function(){b(d.parentColumn,g)});break;case T.multiSelect:a(g.master.candidateControl).bind("dblclick",function(){b(d.parentColumn,g)}),a(g.master.resultControl).bind("dblclick",function(){b(d.parentColumn,g)}),a(g.master.addControl).bind("click",function(){b(d.parentColumn,g)}),a(g.master.removeControl).bind("click",function(){b(d.parentColumn,g)})}b(d.parentColumn,g)},a.fn.SPServices.SPComplexToSimpleDropdown=function(b){var c=a.extend({},{columnName:"",completefunc:null,debug:!1},b),d=a().SPServices.SPDropdownCtl({displayName:c.columnName});if(null===d.Obj.html()&&c.debug)return void x("SPServices.SPComplexToSimpleDropdown","columnName: "+c.columnName,P);if(d.Type===T.complex){var e=a(d.Obj).attr("choices").split("|"),f=d.optHid.val(),g=z("SPComplexToSimpleDropdown",c.columnName),h="<select id='"+g+"' title='"+c.columnName+"'>";for(sb=0;sb<e.length;sb+=2){var i=e[sb+1]===f?" selected='selected' ":" ";h+="<option"+i+"value='"+e[sb+1]+"'>"+e[sb]+"</option>"}h+="</select>",a(d.Obj).closest("td").prepend(h),a(d.Obj).closest("span").find("img").remove(),a(d.Obj).closest("span").find("input").hide(),a("#"+g).change(function(){var b=a(this).val();d.optHid.val(b),a(d.Obj).val(a(this).find("option[value='"+("0"!==b?b:"")+"']").html())}),a("#"+g).trigger("change"),null!==c.completefunc&&c.completefunc()}},a.fn.SPServices.SPDisplayRelatedInfo=function(b){var d,e,f=a.extend({},{columnName:"",relatedWebURL:"",relatedList:"",relatedListColumn:"",relatedColumns:[],displayFormat:"table",headerCSSClass:"ms-vh2",rowCSSClass:"ms-vb",CAMLQuery:"",numChars:0,matchType:"Eq",matchOnId:!1,completefunc:null,debug:!1},b),g=[],h="SPServices.SPDisplayRelatedInfo",i=a().SPServices.SPDropdownCtl({displayName:f.columnName});if(null===i.Obj.html()&&f.debug)return void x(h,"columnName: "+f.columnName,P);switch(d=z("SPDisplayRelatedInfo",f.columnName),a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:f.relatedWebURL,listName:f.relatedList,completefunc:function(b){for(a(b.responseXML).find("faultcode").each(function(){return f.debug?void x(h,"relatedList: "+f.relatedList,"List not found"):void 0}),e=a(b.responseXML).find("List"),sb=0;sb<f.relatedColumns.length;sb++)g[f.relatedColumns[sb]]=a(b.responseXML).find("Fields > Field[Name='"+f.relatedColumns[sb]+"']");g[f.relatedListColumn]=a(b.responseXML).find("Fields > Field[Name='"+f.relatedListColumn+"']")}}),i.Type){case T.simple:i.Obj.bind("change",function(){c(f,d,e,g)});break;case T.complex:i.optHid.bind("propertychange",function(){c(f,d,e,g)});break;case T.multiSelect:f.debug&&x(h,"columnName: "+f.columnName,"Multi-select columns not supported by this function")}c(f,d,e,g)},a.fn.SPServices.SPFilterDropdown=function(b){var c,d,e=a.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListColumn:"",relationshipListSortColumn:"",relationshipListSortAscending:!0,columnName:"",listName:a().SPServices.SPListNameFromUrl(),promptText:"",noneText:"(None)",CAMLQuery:"",CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns><ViewAttributes Scope='RecursiveAll'/></QueryOptions>",completefunc:null,debug:!1},b),f="",g=null,h="SPServices.SPFilterDropdown",i=a().SPServices.SPDropdownCtl({displayName:e.columnName});if(null===i.Obj.html()&&e.debug)return void x(h,"columnName: "+e.columnName,P);g=w(i,!0);var j=e.relationshipListSortColumn.length>0?e.relationshipListSortColumn:e.relationshipListColumn,k=e.relationshipListSortAscending===!0?"":"Ascending='FALSE'",l="<Query><OrderBy><FieldRef Name='"+j+"' "+k+"/></OrderBy><Where>";e.CAMLQuery.length>0&&(l+=e.CAMLQuery),l+="</Where></Query>",a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:e.listName,completefunc:function(b){a(b.responseXML).find("Fields").each(function(){a(this).find("Field[DisplayName='"+e.columnName+"']").each(function(){return d="TRUE"===a(this).attr("Required")?!0:!1,!1})})}}),a().SPServices({operation:"GetListItems",async:!1,webURL:e.relationshipWebURL,listName:e.relationshipList,CAMLQuery:l,CAMLViewFields:"<ViewFields><FieldRef Name='"+e.relationshipListColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:e.CAMLQueryOptions,completefunc:function(b){switch(a(b.responseXML).find("errorstring").each(function(){var b=a(this).text();e.debug&&"One or more field types are not installed properly. Go to the list settings page to delete these fields."===b?x(h,"relationshipListColumn: "+e.relationshipListColumn,"Not found in relationshipList "+e.relationshipList):e.debug&&"Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."===b&&x(h,"relationshipList: "+e.relationshipList,"List not found")}),i.Type){case T.simple:a(i.Obj).find("option").remove(),!d&&e.promptText.length>0?i.Obj.append("<option value='0'>"+e.promptText.replace(/\{0\}/g,e.columnName)+"</option>"):d||i.Obj.append("<option value='0'>"+e.noneText+"</option>");break;case T.complex:f=d?"":e.noneText+"|0",i.Obj.val("");break;case T.multiSelect:a(i.master.candidateControl).find("option").remove(),c=""}switch(a(b.responseXML).SPFilterNode("z:row").each(function(){var b={},d=a(this).attr("ows_"+e.relationshipListColumn);switch("undefined"!=typeof d&&d.indexOf(";#")>0?b=new L(d):(b.id=a(this).attr("ows_ID"),b.value=d),isNaN(b.id)&&(b.id=a(this).attr("ows_ID")),i.Type){case T.simple:var h=a(this).attr("ows_ID")===g[0]?" selected='selected'":"";i.Obj.append("<option"+h+" value='"+b.id+"'>"+b.value+"</option>");break;case T.complex:b.id===g[0]&&i.Obj.val(b.value),f=f+(f.length>0?"|":"")+b.value+"|"+b.id;break;case T.multiSelect:a(i.master.candidateControl).append("<option value='"+b.id+"'>"+b.value+"</option>"),c+=b.id+"|t"+b.value+"|t |t |t"}}),i.Type){case T.simple:i.Obj.trigger("change");break;case T.complex:i.Obj.attr("choices",f),i.Obj.trigger("propertychange");break;case T.multiSelect:i.master.data="",i.MultiLookupPickerdata.val(c),a(i.master.resultControl).find("option").each(function(){var b=a(this);a(this).attr("selected","selected"),a(i.master.candidateControl).find("option").each(function(){a(this).html()===b.html()&&b.removeAttr("selected")})}),GipRemoveSelectedItems(i.master),a(i.master.candidateControl).find("option").each(function(){var b=a(this);a(i.master.resultControl).find("option").each(function(){a(this).html()===b.html()&&b.remove()})}),GipAddSelectedItems(i.master),i.master.data=GipGetGroupData(c),a(i.master.candidateControl).trigger("dblclick")}}}),null!==e.completefunc&&e.completefunc()},a.fn.SPServices.SPDebugXMLHttpResult=function(b){var c,d=a.extend({},{node:null,indent:0},b),e=3,f=4,g="";if(g+="<table class='ms-vb' style='margin-left:"+3*d.indent+"px;' width='100%'>","DisplayPattern"===d.node.nodeName)g+="<tr><td width='100px' style='font-weight:bold;'>"+d.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+d.node.xml+"</textarea></td></tr>";else if(d.node.hasChildNodes())if(d.node.hasChildNodes()&&d.node.firstChild.nodeType===f)g+="<tr><td width='100px' style='font-weight:bold;'>"+d.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+d.node.parentNode.text+"</textarea></td></tr>";else if(d.node.hasChildNodes()&&d.node.firstChild.nodeType===e)g+="<tr><td width='100px' style='font-weight:bold;'>"+d.node.nodeName+"</td><td>"+G(d.node.firstChild.nodeValue)+"</td></tr>";else{for(g+="<tr><td width='100px' style='font-weight:bold;' colspan='99'>"+d.node.nodeName+"</td></tr>",d.node.attributes&&(g+="<tr><td colspan='99'>"+v(d.node)+"</td></tr>"),g+="<tr><td>",c=0;c<d.node.childNodes.length;c++)g+=a().SPServices.SPDebugXMLHttpResult({node:d.node.childNodes.item(c),indent:d.indent+1});g+="</td></tr>"}else g+="<tr><td width='100px' style='font-weight:bold;'>"+d.node.nodeName+"</td><td>"+(null!==d.node.nodeValue?G(d.node.nodeValue):"&nbsp;")+"</td></tr>",d.node.attributes&&(g+="<tr><td colspan='99'>"+v(d.node)+"</td></tr>");return g+="</table>"},a.fn.SPServices.SPGetCurrentUser=function(b){var c=a.extend({},{webURL:"",fieldName:"Name",fieldNames:{},debug:!1},b);if("ID"===c.fieldName&&"undefined"!=typeof rb.thisUserId)return rb.thisUserId;var d,e="",f={},g=c.fieldNames.length>0?c.fieldNames.length:1,h=c.webURL.length>0?c.webURL:a().SPServices.SPGetCurrentSite();for(a.ajax({async:!1,url:h+"/_layouts/userdisp.aspx?Force=True&"+(new Date).getTime(),complete:function(a){d=a}}),sb=0;g>sb;sb++){if("ID"===c.fieldNames[sb])e=rb.thisUserId;else{var i;i=g>1?RegExp('FieldInternalName="'+c.fieldNames[sb]+'"',"gi"):RegExp('FieldInternalName="'+c.fieldName+'"',"gi"),a(d.responseText).find("table.ms-formtable td[id^='SPField']").each(function(){if(i.test(a(this).html())){switch(a(this).attr("id")){case"SPFieldText":e=a(this).text();break;case"SPFieldNote":e=a(this).find("div").html();break;case"SPFieldURL":e=a(this).find("img").attr("src");break;default:e=a(this).text()}return!1}})}"ID"!==c.fieldNames[sb]&&(e="undefined"!=typeof e?e.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,""):null),g>1&&(f[c.fieldNames[sb]]=e)}return g>1?f:e},a.fn.SPServices.SPLookupAddNew=function(b){var c=a.extend({},{lookupColumn:"",promptText:"Add new {0}",newWindow:!1,ContentTypeID:"",completefunc:null,debug:!1},b),d="SPServices.SPLookupAddNew",e=a().SPServices.SPDropdownCtl({displayName:c.lookupColumn});if(null===e.Obj.html()&&c.debug)return void x(d,"lookupColumn: "+c.lookupColumn,P);var f="",g="",h="";if(a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:a().SPServices.SPListNameFromUrl(),completefunc:function(b){a(b.responseXML).find("Field[DisplayName='"+c.lookupColumn+"']").each(function(){return h=a(this).attr("StaticName"),a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:a(this).attr("List"),completefunc:function(b){a(b.responseXML).find("List").each(function(){g=a(this).attr("WebFullUrl"),g=g!==O?g+O:g})}}),f=A(a(this).attr("List"),"NewForm"),!1})}}),0===g.length&&c.debug)return void x(d,"lookupColumn: "+c.lookupColumn,"This column does not appear to be a lookup column");if(f.length>0){var i=g+f;i+=c.newWindow?(c.ContentTypeID.length>0?"?ContentTypeID="+c.ContentTypeID:"")+"' target='_blank'":"?"+(c.ContentTypeID.length>0?"ContentTypeID="+c.ContentTypeID+"&":"")+"Source="+K(location.href)+"'";var j="<div id='SPLookupAddNew_"+h+"'><a href='"+i+">"+c.promptText.replace(/\{0\}/g,c.lookupColumn)+"</a></div>";a(e.Obj).parents("td.ms-formbody").append(j)}else if(c.debug)return void x(d,"lookupColumn: "+c.lookupColumn,"NewForm cannot be found");null!==c.completefunc&&c.completefunc()},a.fn.SPServices.SPGetLastItemId=function(b){var c,d=a.extend({},{webURL:"",listName:"",userAccount:"",CAMLQuery:""},b),e=0;a().SPServices({operation:"GetUserInfo",webURL:d.webURL,async:!1,userLoginName:""!==d.userAccount?d.userAccount:a().SPServices.SPGetCurrentUser(),completefunc:function(b){a(b.responseXML).find("User").each(function(){c=a(this).attr("ID")})}});var f="<Query><Where>";return d.CAMLQuery.length>0&&(f+="<And>"),f+="<Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>"+c+"</Value></Eq>",d.CAMLQuery.length>0&&(f+=d.CAMLQuery+"</And>"),f+="</Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>",a().SPServices({operation:"GetListItems",async:!1,webURL:d.webURL,listName:d.listName,CAMLQuery:f,CAMLViewFields:"<ViewFields><FieldRef Name='ID'/></ViewFields>",CAMLRowLimit:1,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(b){a(b.responseXML).SPFilterNode("z:row").each(function(){e=a(this).attr("ows_ID")})}}),e},a.fn.SPServices.SPRequireUnique=function(b){var c=a.extend({},{columnStaticName:"Title",duplicateAction:0,ignoreCase:!1,initMsg:"This value must be unique.",initMsgCSSClass:"ms-vb",errMsg:"This value is not unique.",errMsgCSSClass:"ms-formvalidation",showDupes:!1,completefunc:null},b),d=a().SPServices.SPGetQueryString(),e=d.ID;rb.thisList=a().SPServices.SPListNameFromUrl();var f="<span id='SPRequireUnique"+c.columnStaticName+"' class='{0}'>{1}</span><br/>",g=f.replace(/\{0\}/g,c.initMsgCSSClass).replace(/\{1\}/g,c.initMsg),h=a().SPServices.SPGetDisplayFromStatic({listName:rb.thisList,columnStaticName:c.columnStaticName}),i=a("input[Title='"+h+"']");a(i).parent().append(g),a(i).blur(function(){var b=[],d=a(this).val();if(0===d.length)return!1;a().SPServices({operation:"GetListItems",async:!1,listName:rb.thisList,CAMLQuery:"<Query><Where><IsNotNull><FieldRef Name='"+c.columnStaticName+"'/></IsNotNull></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='ID' /><FieldRef Name='"+c.columnStaticName+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(f){var g=c.ignoreCase?d.toUpperCase():d;a(f.responseXML).SPFilterNode("z:row").each(function(){var d=c.ignoreCase?a(this).attr("ows_"+c.columnStaticName).toUpperCase():a(this).attr("ows_"+c.columnStaticName);g===d&&a(this).attr("ows_ID")!==e&&b.push([a(this).attr("ows_ID"),a(this).attr("ows_"+c.columnStaticName)])})}});var f=c.initMsg;if(a("span#SPRequireUnique"+c.columnStaticName).html(f).attr("class",c.initMsgCSSClass),a("input[value='OK']:disabled, input[value='Save']:disabled").removeAttr("disabled"),b.length>0&&(f=c.errMsg,a("span#SPRequireUnique"+c.columnStaticName).html(f).attr("class",c.errMsgCSSClass),1===c.duplicateAction&&(a("input[Title='"+c.columnDisplayName+"']").focus(),a("input[value='OK'], input[value='Save']").attr("disabled","disabled")),c.showDupes)){var g=" "+b.length+" duplicate item"+(b.length>1?"s":"")+": ";for(sb=0;sb<b.length;sb++)g+="<a href='DispForm.aspx?ID="+b[sb][0]+"&Source="+location.href+"'>"+b[sb][1]+"</a> ";a("span#SPRequireUnique"+c.columnStaticName).append(g)}}),null!==c.completefunc&&c.completefunc()},a.fn.SPServices.SPGetDisplayFromStatic=function(b){var c=a.extend({},{webURL:"",listName:"",columnStaticName:"",columnStaticNames:{}},b),d="",e={},f=c.columnStaticNames.length>0?c.columnStaticNames.length:1;return a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:c.webURL,listName:c.listName,completefunc:function(b){if(f>1)for(sb=0;f>sb;sb++)e[c.columnStaticNames[sb]]=a(b.responseXML).find("Field[StaticName='"+c.columnStaticNames[sb]+"']").attr("DisplayName");else d=a(b.responseXML).find("Field[StaticName='"+c.columnStaticName+"']").attr("DisplayName")}}),f>1?e:d},a.fn.SPServices.SPGetStaticFromDisplay=function(b){var c=a.extend({},{webURL:"",listName:"",columnDisplayName:"",columnDisplayNames:{}},b),d="",e={},f=c.columnDisplayNames.length>0?c.columnDisplayNames.length:1;return a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:c.webURL,listName:c.listName,completefunc:function(b){if(f>1)for(sb=0;f>sb;sb++)e[c.columnDisplayNames[sb]]=a(b.responseXML).find("Field[DisplayName='"+c.columnDisplayNames[sb]+"']").attr("StaticName");else d=a(b.responseXML).find("Field[DisplayName='"+c.columnDisplayName+"']").attr("StaticName")}}),f>1?e:d},a.fn.SPServices.SPRedirectWithID=function(b){var c=a.extend({},{redirectUrl:"",qsParamName:"ID"},b);rb.thisList=a().SPServices.SPListNameFromUrl();var d=a().SPServices.SPGetQueryString(),e=d.ID,f=d.List,g=d.RootFolder,h=d.ContentTypeId;if("undefined"==typeof d.ID)e=a().SPServices.SPGetLastItemId({listName:rb.thisList}),a("form[name='aspnetForm']").each(function(){var b=location.href.indexOf("?")>0?location.href.substring(0,location.href.indexOf("?")):location.href,c="string"==typeof d.Source?"Source="+d.Source.replace(/\//g,"%2f").replace(/:/g,"%3a"):"",i=[];"undefined"!=typeof f&&i.push("List="+f),"undefined"!=typeof g&&i.push("RootFolder="+g),"undefined"!=typeof h&&i.push("ContentTypeId="+h);var j=b+(i.length>0?"?"+i.join("&")+"&":"?")+"Source="+b+"?ID="+e+(c.length>0?"%26RealSource="+d.Source:"")+("string"==typeof d.RedirectURL?"%26RedirectURL="+d.RedirectURL:"");a(this).attr("action",j)});else{for(;d.ID===e;)e=a().SPServices.SPGetLastItemId({listName:rb.thisList});var i="string"==typeof d.RedirectURL?d.RedirectURL:c.redirectUrl;location.href=i+"?"+c.qsParamName+"="+e+("string"==typeof d.RealSource?"&Source="+d.RealSource:"")}},a.fn.SPServices.SPSetMultiSelectSizes=function(b){var c=a.extend({},{multiSelectColumn:"",minWidth:0,maxWidth:0,debug:!1},b),d="SPServices.SPSetMultiSelectSizes",e=a().SPServices.SPDropdownCtl({displayName:c.multiSelectColumn});if(null===e.Obj.html()&&c.debug)return void x(d,"multiSelectColumn: "+c.multiSelectColumn,P);if(e.Type!==T.multiSelect&&c.debug)return void x(d,"multiSelectColumn: "+c.multiSelectColumn,"Column is not multi-select.");var f=z("SPSetMultiSelectSizes",c.multiSelectColumn),g=a("<select id='"+f+"' ></select>").appendTo(e.container);g.css({width:"auto",height:0,visibility:"hidden"}),a(e.master.candidateControl).find("option").each(function(){g.append("<option value='"+a(this).html()+"'>"+a(this).html()+"</option>")}),a(e.master.resultControl).find("option").each(function(){g.append("<option value='"+a(this).val()+"'>"+a(this).html()+"</option>")});var h=g.width()+5,i=h;(c.minWidth>0||c.maxWidth>0)&&(h<c.minWidth&&(h=c.minWidth),i<c.minWidth&&(i=c.minWidth),i>c.maxWidth&&(i=c.maxWidth));var j=h;a(e.master.candidateControl).css("width",j+"px").parent().css("width",i+"px"),a(e.master.resultControl).css("width",j+"px").parent().css("width",i+"px"),g.remove()},a.fn.SPServices.SPScriptAudit=function(b){var c,e=a.extend({},{webURL:"",listName:"",outputId:"",auditForms:!0,auditViews:!0,auditPages:!0,auditPagesListName:"Pages",showHiddenLists:!1,showNoScript:!1,showSrc:!0},b),f=[["New","NewForm.aspx",!1],["Display","DispForm.aspx",!1],["Edit","EditForm.aspx",!1]];a("#"+e.outputId).append("<table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1><tr><th></th><th>List</th><th>Page Class</th><th>Page Type</th><th>Page</th>"+(e.showSrc?"<th>Script References</th>":"")+"</tr></table>"),a("#SPScriptAudit th").attr("class","ms-vh2-nofilter"),(e.auditForms||e.auditViews)&&a().SPServices({operation:"GetListCollection",webURL:e.webURL,async:!1,completefunc:function(b){a(b.responseXML).find("List").each(function(){c=a(this),(0===e.listName.length||c.attr("Title")===e.listName)&&(e.showHiddenLists&&"False"===c.attr("Hidden")||!e.showHiddenLists)&&(e.auditForms&&a().SPServices({operation:"GetListContentTypes",webURL:e.webURL,listName:c.attr("ID"),async:!1,completefunc:function(b){a(b.responseXML).find("ContentType").each(function(){if("0x0120"!==a(this).attr("ID").substring(0,6)){var b=a(this).find("FormUrls");for(sb=0;sb<f.length;sb++)if(a(b).find(f[sb][0]).each(function(){d(e,c,"Form",this.nodeName,(e.webURL.length>0?e.webURL:a().SPServices.SPGetCurrentSite())+O+a(this).text()),f[sb][2]=!0}),!f[sb][2]){var g=c.attr("DefaultViewUrl");d(e,c,"Form",f[sb][0],g.substring(0,g.lastIndexOf(O)+1)+f[sb][1])}for(sb=0;sb<f.length;sb++)f[sb][2]=!1}})}}),e.auditViews&&a().SPServices({operation:"GetViewCollection",webURL:e.webURL,listName:c.attr("ID"),async:!1,completefunc:function(b){a(b.responseXML).find("View").each(function(){d(e,c,"View",a(this).attr("DisplayName"),a(this).attr("Url"))
})}}))})}});var g=0,h=[];if("string"==typeof e.auditPagesListName?(g=1,h.push(e.auditPagesListName)):(g=e.auditPagesListName.length,h=e.auditPagesListName),e.auditPages)for(sb=0;g>sb;sb++)a().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:e.webURL,listName:h[sb],completefunc:function(b){a(b.responseXML).find("List").each(function(){c=a(this)})}}),a().SPServices({operation:"GetListItems",async:!1,webURL:e.webURL,listName:h[sb],CAMLQuery:"<Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder</Value></Neq></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/></ViewFields>",CAMLRowLimit:0,completefunc:function(b){a(b.responseXML).SPFilterNode("z:row").each(function(){var b=a(this).attr("ows_FileRef").split(";#")[1],f=a(this).attr("ows_Title"),g="undefined"!=typeof f?f:"";b.indexOf(".aspx")>0&&d(e,c,"Page",g,O+b)})}});a("#SPScriptAudit tr[class='ms-alternating']:even").removeAttr("class")},a.fn.SPServices.SPArrangeChoices=function(b){var c,d=a.extend({},{listName:a().SPServices.SPListNameFromUrl(),columnName:"",perRow:99,randomize:!1},b),e=!1,f=[],g=a().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:d.listName});g.done(function(){a(g.responseXML).find("Field[DisplayName='"+d.columnName+"']").each(function(){return e="TRUE"===a(this).attr("FillInChoice")?!0:!1,!1});var b,h,i=C(d.columnName),j=a(i).find("tr").length,k=0;for(a(i).find("tr").each(function(){k++,e&&k===j-1?b=a(this).find("td").html():e&&k===j?h=a(this).find("td").html():f.push(a(this).html())}),c="<TR>",d.randomize&&f.sort(F),sb=0;sb<f.length;sb++)c+=f[sb],(sb+1)%d.perRow===0&&(c+="</TR><TR>");c+="</TR>",e&&(c+="<TR><TD colspan='99'>"+b+h+"</TD></TR>"),a(i).find("tr").remove(),a(i).find("table").append(c)})},a.fn.SPServices.SPAutocomplete=function(b){var c,d=a.extend({},{webURL:"",sourceList:"",sourceColumn:"",columnName:"",CAMLQuery:"",CAMLQueryOptions:"<QueryOptions></QueryOptions>",CAMLRowLimit:0,filterType:"BeginsWith",numChars:0,ignoreCase:!1,highlightClass:"",uniqueVals:!1,maxHeight:99999,slideDownSpeed:"fast",processingIndicator:"_layouts/images/REFRESH.GIF",debug:!1},b),e=a("input[Title='"+d.columnName+"']");e.css("position","");var f=e.css("color"),g=e.css("width");if(null===e.html()&&d.debug)return void x("SPServices.SPAutocomplete","columnName: "+d.columnName,"Column is not an input control or is not found on page");e.closest("span").find("br").remove(),e.wrap("<div>");var h=z("SPAutocomplete",d.columnName);e.after("<div><ul id='"+h+"' style='width:"+g+";display:none;padding:2px;border:1px solid #2A1FAA;background-color:#FFF;position:absolute;z-index:40;margin:0'></div>"),a("#"+h).css("width",g),a(e).keyup(function(){var b=a(this).val();if(a("#"+h).hide(),b.length<d.numChars)return!1;e.css({"background-image":"url("+d.processingIndicator+")","background-position":"right","background-repeat":"no-repeat"});var g=[],i="<Query><OrderBy><FieldRef Name='"+d.sourceColumn+"'/></OrderBy><Where>";d.CAMLQuery.length>0&&(i+="<And>"),i+="<"+d.filterType+"><FieldRef Name='"+d.sourceColumn+"'/><Value Type='Text'>"+b+"</Value></"+d.filterType+">",d.CAMLQuery.length>0&&(i+=d.CAMLQuery+"</And>"),i+="</Where></Query>",a().SPServices({operation:"GetListItems",async:!1,webURL:d.WebURL,listName:d.sourceList,CAMLQuery:i,CAMLQueryOptions:d.CAMLQueryOptions,CAMLViewFields:"<ViewFields><FieldRef Name='"+d.sourceColumn+"' /></ViewFields>",CAMLRowLimit:d.CAMLRowLimit,completefunc:function(c){var e=d.ignoreCase?b.toUpperCase():b;a(c.responseXML).SPFilterNode("z:row").each(function(){var b=a(this).attr("ows_"+d.sourceColumn),c=d.ignoreCase?a(this).attr("ows_"+d.sourceColumn).toUpperCase():a(this).attr("ows_"+d.sourceColumn);if("Contains"===d.filterType){var f=c.indexOf(e);f>=0&&(!d.uniqueVals||-1===a.inArray(b,g))&&g.push(a(this).attr("ows_"+d.sourceColumn))}else e!==c.substr(0,e.length)||d.uniqueVals&&-1!==a.inArray(b,g)||g.push(a(this).attr("ows_"+d.sourceColumn))})}});var j="";for(sb=0;sb<g.length;sb++){if(d.highlightClass.length>0){var k=new RegExp(b,d.ignoreCase?"gi":"g"),l=g[sb].match(k),m=0;for(c=0;c<l.length;c++){var n=g[sb].indexOf(l[c],m),o=n+l[c].length,p="<span class='"+d.highlightClass+"'>"+l[c]+"</span>";g[sb]=g[sb].substr(0,n)+p+g[sb].substr(o),m=n+p.length}}j+="<li style='display: block;position: relative;cursor: pointer;'>"+g[sb]+"</li>"}a("#"+h).html(j),a("#"+h+" li").click(function(){a("#"+h).fadeOut(d.slideUpSpeed),e.val(a(this).text())}).mouseover(function(){var b={cursor:"hand",color:"#ffffff",background:"#3399ff"};a(this).css(b)}).mouseout(function(){var b={cursor:"inherit",color:f,background:"transparent"};a(this).css(b)}),g.length>0&&a("#"+h).slideDown(d.slideDownSpeed),e.css("background-image","")})},a.fn.SPServices.SPGetQueryString=function(b){for(var c=a.extend({},{lowercase:!1},b),d={},e=location.search.slice(1).split("&"),f=0;f<e.length;f++){var g=e[f].split("="),h=c.lowercase?g[0].toLowerCase():g[0];d[h]=decodeURIComponent(g[1]||"")}return d},a.fn.SPServices.SPListNameFromUrl=function(b){var c=a.extend({},{listName:""},b);if(c.listName.length>0)return rb.thisList=c.listName,rb.thisList;if(rb.thisList.length>0)return rb.thisList;var d=location.href,e=d.substring(0,d.indexOf(".aspx")),f=decodeURIComponent(e.substring(0,e.lastIndexOf(O)+1)).toUpperCase();return a().SPServices({operation:"GetListCollection",async:!1,completefunc:function(b){a(b.responseXML).find("List").each(function(){var b=a(this).attr("DefaultViewUrl"),c=b.substring(0,b.lastIndexOf(O)+1).toUpperCase();return f.indexOf(c)>0?(rb.thisList=a(this).attr("ID"),!1):void 0})}}),rb.thisList},a.fn.SPServices.SPUpdateMultipleListItems=function(b){var c,d=a.extend({},{webURL:"",listName:"",CAMLQuery:"",batchCmd:"Update",valuepairs:[],completefunc:null,debug:!1},b),e=[],f=[];a().SPServices({operation:"GetListItems",async:!1,webURL:d.webURL,listName:d.listName,CAMLQuery:d.CAMLQuery,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(b){a(b.responseXML).SPFilterNode("z:row").each(function(){e.push(a(this).attr("ows_ID"));var b=a(this).attr("ows_FileRef");b="/"+b.substring(b.indexOf(";#")+2),f.push(b)})}});var g,h="<Batch OnError='Continue'>";for(c=0;c<e.length;c++){for(h+="<Method ID='"+c+"' Cmd='"+d.batchCmd+"'>",g=0;g<d.valuepairs.length;g++)h+="<Field Name='"+d.valuepairs[g][0]+"'>"+J(d.valuepairs[g][1])+"</Field>";h+="<Field Name='ID'>"+e[c]+"</Field>",f[c].length>0&&(h+="<Field Name='FileRef'>"+f[c]+"</Field>"),h+="</Method>"}h+="</Batch>",a().SPServices({operation:"UpdateListItems",async:!1,webURL:d.webURL,listName:d.listName,updates:h,completefunc:function(a){null!==d.completefunc&&d.completefunc(a)}})},a.fn.SPServices.SPGetListItemsJson=function(b){var c,d=a.extend({},{webURL:"",listName:"",CAMLViewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:"",CAMLQueryOptions:"",changeToken:"",contains:"",mapping:null,mappingOverrides:null,debug:!1},b),e={},f=[],g=a.Deferred(),h=a().SPServices({operation:"GetListItemChangesSinceToken",webURL:d.webURL,listName:d.listName,CAMLViewName:d.CAMLViewName,CAMLQuery:d.CAMLQuery,CAMLViewFields:d.CAMLViewFields,CAMLRowLimit:d.CAMLRowLimit,CAMLQueryOptions:d.CAMLQueryOptions,changeToken:d.changeToken,contains:d.contains});return h.done(function(){var b="SPGetListItemsJson"+d.webURL+d.listName,i=a(h.responseXML);if(c=i.find("Changes").attr("LastChangeToken"),i.find("listitems Changes Id[ChangeType='Delete']").each(function(){f.push(a(this).text())}),null===d.mapping?i.find("List > Fields > Field").each(function(){var b=a(this),c=b.attr("Type");a.inArray(c,U)>=0&&(e["ows_"+b.attr("Name")]={mappedName:b.attr("Name"),objectType:b.attr("Type")})}):e=d.mapping,null!==d.mappingOverrides)for(var j in d.mappingOverrides)e[j]=d.mappingOverrides[j];a.isEmptyObject(e)?e=a(document).data(b):a(document).data(b,e);var k=i.SPFilterNode("z:row").SPXmlToJson({mapping:e,sparse:!0}),l={changeToken:c,mapping:e,data:k,deletedIds:f};g.resolveWith(l)}),g.promise()},a.fn.SPServices.SPConvertDateToISO=function(b){var c=a.extend({},{dateToConvert:new Date,dateOffset:"-05:00"},b),d="",e=c.dateToConvert;return d+=e.getFullYear()+"-",d+=M(e.getMonth()+1)+"-",d+=M(e.getDate()),d+="T"+M(e.getHours())+":",d+=M(e.getMinutes())+":",d+=M(e.getSeconds())+"Z"+c.dateOffset},a.fn.SPFilterNode=function(a){return this.find("*").filter(function(){return this.nodeName===a})},a.fn.SPXmlToJson=function(b){var c,d=a.extend({},{mapping:{},includeAllAttrs:!1,removeOws:!0,sparse:!1},b),e=[];return this.each(function(){var b={},f=this.attributes;for(d.sparse||a.each(d.mapping,function(){b[this.mappedName]=""}),c=0;c<f.length;c++){var h=f[c].name,i=d.mapping[h],j="undefined"!=typeof i?i.mappedName:d.removeOws?h.split("ows_")[1]:h,k="undefined"!=typeof i?i.objectType:void 0;(d.includeAllAttrs||void 0!==i)&&(b[j]=g(f[c].value,k))}e.push(b)}),e},a.fn.SPServices.SPFindPeoplePicker=function(b){var c=a.extend({},{peoplePickerDisplayName:"",valueToSet:"",checkNames:!0},b),d=a("nobr").filter(function(){return a(this).contents().eq(0).text()===c.peoplePickerDisplayName}).closest("tr"),e=d.find("div[name='upLevelDiv']"),f=d.find("img[Title='Check Names']:first");c.valueToSet.length>0&&e.html(c.valueToSet),c.checkNames&&f.click();var g=a.trim(e.text()),h=[];return e.children("span").each(function(){var b=a(this).find("div[data]").attr("data"),c={};if("undefined"!=typeof b){var d=a.parseXML(b),e=a(d);e.find("DictionaryEntry").each(function(){var b=a(this).find("Key").text(),d=a(this).find("Value").text();c[b]=d}),h.push(c)}else a().SPServices({operation:"GetUserInfo",async:!1,cacheXML:!0,userLoginName:a(this).attr("title"),completefunc:function(b){a(b.responseXML).find("User").each(function(){a.each(this.attributes,function(a,b){var d=b.name,e=b.value;c[d]=e}),h.push(c)})}})}),{row:d,contents:e,currentValue:g,checkNames:f,dictionaryEntries:h}},a.fn.SPServices.Version=function(){return N},a.fn.SPServices.SPDropdownCtl=function(b){var c=a.extend({},{displayName:""},b),d={},e=a().SPServices.SPGetStaticFromDisplay({listName:a().SPServices.SPListNameFromUrl(),columnDisplayName:c.displayName});if(d.Type=1===(d.Obj=a("select[Title='"+c.displayName+"']")).length?T.simple:1===(d.Obj=a("input[Title='"+c.displayName+"']")).length?T.complex:1===(d.Obj=a("select:regex(id, ("+e+")(_)[0-9a-fA-F]{8}(-))")).length?T.simple:1===(d.Obj=a("select[ID$='SelectCandidate'][Title^='"+c.displayName+" ']")).length?T.multiSelect:1===(d.Obj=a("select[ID$='SelectCandidate'][Title$=': "+c.displayName+"']")).length?T.multiSelect:1===(d.Obj=a("select[ID$='SelectCandidate'][Title$='\""+c.displayName+"\".']")).length?T.multiSelect:1===(d.Obj=a("select[ID$='SelectCandidate'][Title$=' "+c.displayName+"']")).length?T.multiSelect:null,null===d.Type){var f=C(c.displayName);if(void 0!==f){var g=f.find("select[title^='"+c.displayName+"'][id$='$Lookup']");g&&1===g.length&&(d.Type=T.simple,d.Obj=g)}}if(d.Type===T.complex)d.optHid=a("input[id='"+d.Obj.attr("optHid")+"']");else if(d.Type===T.multiSelect){d.container=d.Obj.closest("span"),d.MultiLookupPickerdata=d.container.find("input[id$='"+R+"_data'], input[id$='"+S+"_data']");var h=d.container.find("[id$='AddButton']").attr("id");d.master=window[h.replace(/AddButton/,R+"_m")]||window[h.replace(/AddButton/,S+"_m")]}return d};var xb={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};a.expr[":"].regex=function(a,b,c){var d=c[3].split(","),e=/^(data|css):/,f={method:d[0].match(e)?d[0].split(":")[0]:"attr",property:d.shift().replace(e,"")},g="ig",h=new RegExp(d.join("").replace(/^\s+|\s+$/g,""),g);return h.test(jQuery(a)[f.method](f.property))}}(jQuery);